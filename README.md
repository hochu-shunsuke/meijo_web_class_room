# WebClass / Classroom 課題自動同期システム 導入ガイド

このツールは、あなたのWebClassとGoogle Classroomの課題を自動でGoogle Tasksに登録し、期限切れや完了を自動で管理します。

**設定は最初にたった一度だけ！** 複雑なコマンド操作は一切不要です。

---

## Step 0: 配布フォルダの内容確認(これ理想．今はmain.py動かす．)

システムを動作させるために必要なファイルは、すべてこのフォルダに同梱されています。このフォルダは**デスクトップなど、動かさない場所**に置いてください。

| ファイル名 | 役割 | 備考 |
| :--- | :--- | :--- |
| `WebClass-Sync.exe` | 課題を取得する本体プログラム | Windowsユーザー向けの実行ファイルです。 |
| `GAS_URL.txt` | 連携用URLを貼り付ける設定ファイル | **このファイルに、Step 1で取得するURLを貼り付けます。** |
| `自動実行を登録.bat` | スケジュールを自動設定するファイル | ダブルクリックするだけで毎日自動で動くようになります。 |
| `key.key` | (自動生成) 暗号化キー | 初回実行後、このフォルダに自動生成されます。 |
| `userdata.txt` | (自動生成) 暗号化されたID/PW | 初回実行後、このフォルダに自動生成されます。 |

---

## Step 1: 魔法のスプレッドシートの設定 (最初の一回だけ)

Google Tasksへの自動登録を可能にするための「心臓部」の設定です。

### 1-1. スプレッドシートのコピー

1.  配布された**【魔法の課題管理テンプレート】**のスプレッドシートを開きます。
2.  メニューから「**ファイル**」→「**コピーを作成**」を選択し、自分のGoogle Driveに保存してください。
    * これで、GASコードを含めたシステム全体があなたのGoogleアカウントで動作するようになります。

### 1-2. WebアプリのURLを取得

GAS（Google Apps Script）が外部からデータを受け取るための専用URLを取得します。

1.  コピーした新しいスプレッドシートを開きます。
2.  メニューバーに表示された「**✨ システム初期設定 ✨**」をクリックします。
3.  ドロップダウンから「**Web連携用URLを表示**」を選択します。
4.  画面に表示された**長いURL**をすべてコピーします。

### 1-3. URLをシステムに設定

1.  **`WebClass自動同期`**フォルダに戻ります。
2.  フォルダ内の**`GAS_URL.txt`**をダブルクリックして開きます。
3.  **Step 1-2でコピーしたURLをファイルに貼り付け**て、保存して閉じます。

---

## Step 2: WebClassの資格情報設定 (最初の一回だけ)

あなたのWebClassアカウント情報をシステムに安全に登録します。

1.  **`WebClass-Sync.exe`**をダブルクリックして実行します。
2.  黒い画面が表示され、「`userid:`」と「`password:`」の入力が求められます。
3.  **WebClassで使用している学籍番号とパスワード**を入力してください。
4.  入力後、情報はすぐに暗号化され、`key.key`と`userdata.txt`として保存されます。
    * **次回以降、この入力は求められません。**
5.  画面が自動で閉じれば成功です。スプレッドシートの「WebClass課題」シートにデータが書き込まれたか確認してください。

---

## Step 3: 自動実行スケジュールへの登録 (最後の一回だけ)

毎日自動で課題チェックが動くように設定します。複雑なタスクスケジューラ画面は開きません。

1.  **`WebClass自動同期`**フォルダに戻ります。
2.  **`自動実行を登録.bat`**を**ダブルクリック**して実行します。
3.  画面に「【完了】毎日 午前5:00 の自動実行が登録されました。」というメッセージが表示されたら成功です。
4.  **`Enter`キー**を押して画面を閉じます。

### 最終確認

* Google Tasksに「**大学課題**」というリストが作成されているか確認してください。（リスト名がTasksに登録されます。）

---

**これで設定はすべて完了です！**

このシステムが毎日午前5:00にWebClass/Classroomの最新情報を取得し、午前5:10にGoogle Tasksに登録します。あなたは何もしなくても、毎日最新の課題がタスクリストに届きます。